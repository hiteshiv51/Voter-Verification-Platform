<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Citizen Access</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="citizen.css">
</head>

<body>

<!-- HEADER -->
<header class="top-header">
    <h1>Citizen Access Portal</h1>
    <p>Read-only account overview</p>
</header>

<main class="container">

    <!-- ACCOUNT CARD -->
    <section class="card">
        <h2>Account Information</h2>

        <div class="info-row">
            <span>Email</span>
            <span id="userEmail" class="value">Loading...</span>
        </div>

        <div class="info-row">
            <span>Role</span>
            <span class="badge citizen">Citizen</span>
        </div>

        <div class="info-row">
            <span>Status</span>
            <span class="badge active">Active</span>
        </div>
    </section>

    <!-- NOTICE -->
    <section class="card warning">
        <h2>Access Notice</h2>
        <p>
            Confidential voter analytics and verification tools
            are available only to authorized election authorities.
        </p>
        <p class="muted">
            This page provides transparency through read-only access.
        </p>
    </section>

    <!-- ACTION -->
    <section class="card actions">
        <button id="logoutBtn">Logout</button>
    </section>

</main>

<footer>
    <p>Transparency · Privacy · Responsible Access</p>
</footer>

<!-- FIREBASE SCRIPT (UNCHANGED) -->
<script type="module">
import { initializeApp } from "https://www.gstatic.com/firebasejs/12.7.0/firebase-app.js";
import { getAuth, onAuthStateChanged, signOut }
from "https://www.gstatic.com/firebasejs/12.7.0/firebase-auth.js";
import { getFirestore, doc, getDoc }
from "https://www.gstatic.com/firebasejs/12.7.0/firebase-firestore.js";

const firebaseConfig = {
    apiKey: "AIzaSyDzphuLvs9hmQec6B38J-W01MdPtoIauYY",
    authDomain: "voter-eligiblity-system.firebaseapp.com",
    projectId: "voter-eligiblity-system",
    appId: "1:564125568994:web:fb6734e28da979f85473bb"
};

const app = initializeApp(firebaseConfig);
const auth = getAuth(app);
const db = getFirestore(app);

const emailSpan = document.getElementById("userEmail");
const logoutBtn = document.getElementById("logoutBtn");

onAuthStateChanged(auth, async (user) => {
    if (!user) {
        window.location.href = "index.html";
        return;
    }

    const snap = await getDoc(doc(db, "users", user.uid));
    const role = snap.exists() ? snap.data().role : "";

    if (role !== "Citizen") {
        alert("Unauthorized access");
        window.location.href = "index.html";
        return;
    }

    emailSpan.textContent = user.email;
});

logoutBtn.addEventListener("click", () => {
    signOut(auth).then(() => {
        window.location.href = "index.html";
    });
});
</script>

</body>
</html>